// event_logging/v4/anti_malware_threat_complex_type.proto at 0:0
syntax = "proto3";
package event_logging.v4;

import "event_logging/v4/multi_object_complex_type.proto";
import "event_logging/v4/software_complex_type.proto";
import "event_logging/v4/threat_category_simple_type.proto";
import "google/protobuf/timestamp.proto";
import "buf/validate/validate.proto";

// Type that describes a threat identified by an anti-malware scanner.
message AntiMalwareThreatComplexType {
  // Describes the anti-malware product used.
  SoftwareComplexType product = 1;
  // Describes the anti-malware signature used.
  SignatureType signature = 2;
  // Describes the threat if one has been found.
  ThreatType threat = 3;
  // Describes the infected item if one has been found.
  MultiObjectComplexType infected = 4;

  // Describes the anti-malware signature used.
  message SignatureType {
    // The version of the signature.
    string version = 1;
    // When the signature was last updated.
    google.protobuf.Timestamp updated = 2;
  }
  // Describes the threat if one has been found.
  message ThreatType {
    // The category of the threat, e.g. Worm, Virus, etc.
    ThreatCategorySimpleType category = 1 [
      (buf.validate.field).required = true
    ];
    // The name of the threat, e.g. a virus name.
    string name = 2 [
      (buf.validate.field).required = true
    ];
  }
}
